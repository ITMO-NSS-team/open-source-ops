# Основные use-cases git

Git - это распределенная система управления версиями, разработанная Линусом Торвальдсом. Эта технология позволяет разработчикам сохранять все версии своего проекта и легко возвращаться к предыдущим состояниям. Особенно важным аспектом Git является возможность создания веток, что значительно облегчает совместную работу над проектами. Аналогами Git являются такие системы управления версиями, как Subversion, Perforce, Bazaar, которые также предоставляют средства для контроля за изменениями в проектах. Однако Git выделяется своей популярностью и масштабностью, широко используется в разнообразных областях разработки, и для работы с ним существует множество платформ, включая GitHub, GitLab, Bitbucket. Git позволяет разработчикам с легкостью сотрудничать, а также применяется не только для кода, но и для работы с различными типами файлов.

Ниже располагаются основные концепции и компоненты Git, которые необходимо понимать:
- Репозиторий (Repository) - это хранилище всех файлов, истории изменений и метаданных проекта. Он содержит все коммиты, ветки, теги и конфигурационные файлы. Репозиторий может быть локальным или удаленным;
- Коммит (Commit) - сохраненное состояние проекта в определенный момент времени. Коммит содержит информацию о внесенных изменениях, авторе, дате и сообщении коммита. Коммиты являются основными строительными блоками в истории проекта и образуют дерево коммитов. В качестве общепринятого стиля коммитов можно использовать [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/);
- Ветка (Branch) - это легковесная подвижная ссылка на коммит. Ветки позволяют разработчикам работать над разными фичами или исправлениями ошибок параллельно, не затрагивая основную линию разработки. Каждая ветка имеет свою собственную историю коммитов;
- Ветвление (Branching) - это создание новой ветки на основе существующей. Это позволяет разработчикам работать над различными фичами или задачами независимо друг от друга. Каждая ветка имеет свою собственную историю коммитов и изменения в одной ветке не влияют на другие ветки.
- Слияние (Merge) позволяет объединить изменения из одной ветки с другой. При слиянии Git автоматически интегрирует изменения из двух разных веток, результирующий коммит объединяет изменения обеих веток;
- Удаленный репозиторий (Remote Repository) - это репозиторий, расположенный на удаленном сервере или в облачном хранилище. Он предоставляет доступ к репозиторию другим разработчикам для совместной работы над проектом. Удаленный репозиторий позволяет разработчикам обмениваться коммитами и синхронизировать изменения;
- Клонирование (Clone) - создание локальной копии удаленного репозитория. Клонирование позволяет разработчику получить полную копию истории, файлов и веток проекта, которую можно изменять и коммитить локально;
- Индекс (Index или Staging Area) - это промежуточное хранилище, где разработчик помещает измененные файлы перед коммитом. Файлы, добавленные в индекс, готовы к коммиту и будут включены в следующий коммит.

## Основные команды Git

### Создание репозитория

`git init`: создание нового репозитория в текущей директории, в результате чего создается новая директория .git, где хранится вся информация о репозитории, коммитах, ветках и настройках
`git clone <URL>`: клонирование удаленного репозитория Git в локальную директорию - загружаются все коммиты, ветки и файлы из удаленного репозитория и создается локальная копия проекта

### Внесение изменений

`git status`: вывод измененных или новых файлов, которые в дальнейшем нужно проиндексировать
`git log`: вывод истории коммитов текущей ветки, содержащий хэш коммита, автора, время и сообщение коммита
`git log --oneline`: вариация команды `git log`, которая выводит более краткую историю коммитов, содержащую сокращенный хэш коммита и его сообщение в одной строке
`git diff`: разница между коммитами, ветками или файлами
`git add <file/dir>`: индексация файлы или директория для коммита
`git commit -m "<message name>"`: создание коммита с изменениями, добавленными в индекс

### Работа с ветками

`git branch`: список веток в репозитории
`git branch <branch>`: создание новой ветки
`git checkout <branch>`: переключение между ветками
`git checkout -`: загружает предыдущую ветку, удобно для быстрого переключения
`git stash`: используется для временного сохранения незавершенных изменений, чтобы переключиться на другую ветку или выполнить другие операции без потери работы
`git merge <branch>`: внесение изменения указанной ветки в текущую ветку
`git branch -d <branch>`: удаление указанной ветки
`git rebase <branch>`: переписывание коммитов текущей ветки после коммитов в указанной ветке
`git fetch`: взятие всех изменений из удаленного репозитория и сохранение этих изменений локально
`git pull`: взятие всех изменений из удаленного репозитория и слиянние этих изменений с текущей веткой, работает как комбинация команд `git fetch` и `git merge`
`git push`: устанавливается становление связи с удалённым репозиторием, берутся все отсутствующие изменения удаленного репозитория и далее сохранение этих изменений в удаленный репозиторий

# GitFlow

GitFlow является одной из наиболее популярных стратегий ветвления и слияния для управления версиями в Git. Он предоставляет структуру для эффективного сотрудничества между разработчиками, управления релизами и поддержкой долгосрочных и краткосрочных фич.

Рассмотрим несколько end-to-end сценариев, связанных с работой над опенсорсными проектами, и проиллюстрируем их использование с помощью различных Git-команд. 

## Создание новой фичи

Разработчик хочет добавить новую фичу (функцию) в проект, для этого нужно создать и перейти в соответственную для этой фичи ветку.

`git checkout develop`

`git checkout feature/new-feature`


## Работа над фичей

Разработчик хочет внести изменения в код ветки фичи, для этого он должен коммитить изменения и пушить их в удаленный репозиторий.

`git commit -m "feat: add [feature]"`

`git push origin feature/new-feature`


## Завершение работы над фичей и начало ревью

После завершения работы над фичей, разработчик создает Pull Request для интеграции своих изменений в основную ветку.

`git checkout develop`

`git pull origin develop`

`git checkout feature/new-feature`

`git rebase develop`

`git push origin feature/new-feature`


## Ревью кода и слияние фичи

Другие разработчики рассматривают раннее созданный Pull Request, предлагают изменения и оставляют комментарии. После завершения ревью фича готова к слиянию с основной веткой.

`git checkout develop`

`git pull origin develop`

`git merge --no-ff feature/new-feature`

`git push origin develop`

## Релиз

Для подготовки новый версии проекта создается релизная ветка. Происходит это, когда завершено достаточное количество фич.Разработчик хочет внести изменения в код ветки фичи, для этого он должен коммитить изменения и пушить их в удаленный репозиторий:

`git checkout develop`

`git pull origin develop`

`git checkout release/0.0.1`


## Исправление ошибок в релизе

Если в уже созданном релизе имеются ошибки, разработчики могут исправить их прямо в релизной ветке.

`git commit -m "fix: solved [critical bug]"`

`git push origin release/0.0.1`


## Завершение релиза и создание тега

Когда все ошибки успешно исправлены и релиз готов к выпуску, создается тег. 

`git checkout master`

`git merge --no-ff release/0.0.1`

`git tag -a 0.0.1 -m "Release 0.0.1"`

`git push origin master`

`git push origin --tags`


## Поддержка релиза

Если вдруг после выпуска релиза были обнаружены ошибки, то разработчик может их исправить в той же ветке, закоммитив и внеся изменения.

`git checkout release/0.0.1`

`git commit -a -m "fix: solved [critical post-release bug]"`

`git push origin release/0.0.1`


## Внедрение исправлений в основную ветку

Для того, чтобы внесенные в релизную ветку изменения были доступны в будущем в других релизах, эти изменения могут быть внедрены в основную ветку разработки. Разработчик хочет внести изменения в код ветки фичи, для этого он должен коммитить изменения и пушить их в удаленный репозиторий:

`git checkout develop`

`git pull origin develop`

`git merge --no-ff release/0.0.1`

`git push origin develop`


## Удаление веток

Ненужные ветки, оставшиеся после завершения работы над фичами и релизами могут быть удалены.

`git branch -d feature/new-feature`

`git branch -d release/0.0.1`

`git push origin --delete feature/new-feature`

`git push origin --delete release/0.0.1`

